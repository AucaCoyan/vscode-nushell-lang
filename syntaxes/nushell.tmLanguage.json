{
    "$schema": "https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json",
    "name": "nushell",
    "scopeName": "source.nushell",
    "patterns": [
        { "include": "#string" },
        { "include": "#comment" },
        { "include": "#command" }
    ],
    "repository": {
        "string": {
            "patterns": [
                { "include": "#string-single-quote" },
                { "include": "#string-backtick" },
                { "include": "#string-double-quote" },
                { "include": "#string-interpolated-double" },
                { "include": "#string-interpolated-single" }
            ]
        },
        "string-escape": {
            "match": "\\\\(?:[bfrnt\\'\"/]|u[0-9a-fA-F]{4})",
            "name": "constant.character.escape.nushell"
        },
        "string-expression": {
            "begin": "\\(",
            "beginCaptures": {
				"0": { "name": "meta.brace.round.begin.nushell" }
			},
            "end": "\\)",
            "endCaptures": {
				"0": { "name": "meta.brace.round.end.nushell" }
			},
            "patterns": [
                { "include": "#command" }
            ]
        },
        "string-single-quote": {
            "begin": "'",
            "beginCaptures": {
				"0": { "name": "punctuation.definition.string.begin.nushell" }
			},
            "end": "'",
            "endCaptures": {
				"0": { "name": "punctuation.definition.string.end.nushell" }
			},
            "name": "string.quoted.single.nushell"
        },
        "string-backtick": {
            "begin": "`",
            "beginCaptures": {
				"0": { "name": "punctuation.definition.string.begin.nushell" }
			},
            "end": "`",
            "endCaptures": {
				"0": { "name": "punctuation.definition.string.end.nushell" }
			},
            "name": "string.quoted.single.nushell"
        },
        "string-double-quote": {
            "begin": "\"",
            "beginCaptures": {
				"0": { "name": "punctuation.definition.string.begin.nushell" }
			},
            "end": "\"",
            "endCaptures": {
				"0": { "name": "punctuation.definition.string.end.nushell" }
			},
            "name": "string.quoted.double.nushell",
            "patterns": [
                {"include": "#string-escape"}
            ]
        },
        "string-interpolated-double": {
            "begin": "\\$\"",
            "beginCaptures": {
				"0": { "name": "punctuation.definition.string.begin.nushell" }
			},
            "end": "\"",
            "endCaptures": {
				"0": { "name": "punctuation.definition.string.end.nushell" }
			},
            "name": "string.interpolated.nushell",
            "patterns": [
                {"include": "#string-escape"},
                {
                    "match": "\\\\[()]",
                    "name": "constant.character.escape.nushell"
                },
                {"include": "#string-expression"}
            ]
        },
        "string-interpolated-single": {
            "begin": "\\$'",
            "beginCaptures": {
				"0": { "name": "punctuation.definition.string.begin.nushell" }
			},
            "end": "'",
            "endCaptures": {
				"0": { "name": "punctuation.definition.string.end.nushell" }
			},
            "name": "string.interpolated.nushell",
            "patterns": [
                {"include": "#string-expression"}
            ]
        },
        "comment": {
          "match": "(#.*)$",
          "name": "comment.nushell"
        },
        "keyword": {
            "match": "(?:def(?:-env)?)",
            "name": "keyword.other.nushell"
        },
        "command": {
            "match": "\\^?(?:\\s*\\w+)+",
            "name":"entity.name.function"
        }
    }
}